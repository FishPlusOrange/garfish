<!doctype html>
<html class="docs-version-current" lang="zh-CN" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<script src="https://lf3-static.bytednsdoc.com/obj/eden-cn/dhozeh7vhpebvog/open-garfish/script/slardar-garfish.js"></script><title data-react-helmet="true">插件指南 | Garfish</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://garfishjs.org/guide/advance/plugins"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-CN"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="插件指南 | Garfish"><meta data-react-helmet="true" name="description" content="Garfish 框架引入了插件化机制，目的是为了让开发者能够通过编写插件的方式扩展更多功能，或为自身业务定制个性化功能；同时框架的基础能力也都是通过插件机制来实现，确保框架核心足够精简和稳定。"><meta data-react-helmet="true" property="og:description" content="Garfish 框架引入了插件化机制，目的是为了让开发者能够通过编写插件的方式扩展更多功能，或为自身业务定制个性化功能；同时框架的基础能力也都是通过插件机制来实现，确保框架核心足够精简和稳定。"><link data-react-helmet="true" rel="shortcut icon" href="https://lf3-static.bytednsdoc.com/obj/eden-cn/dhozeh7vhpebvog/open-garfish/icons/icon.png"><link data-react-helmet="true" rel="canonical" href="https://garfishjs.org/guide/advance/plugins"><link data-react-helmet="true" rel="alternate" href="https://garfishjs.org/guide/advance/plugins" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://garfishjs.org/guide/advance/plugins" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3fb5841b.css">
<link rel="preload" href="/assets/js/runtime~main.e3f4e211.js" as="script">
<link rel="preload" href="/assets/js/main.fd9dd10e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_3z0J">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://lf3-static.bytednsdoc.com/obj/eden-cn/dhozeh7vhpebvog/open-garfish/icons/garfish-icon.png" alt="Garfish" class="themedImage_FUAD themedImage--light_3M5g"><img src="https://lf3-static.bytednsdoc.com/obj/eden-cn/dhozeh7vhpebvog/open-garfish/icons/garfish-icon.png" alt="Garfish" class="themedImage_FUAD themedImage--dark_TNfD"></div></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/guide/">指南</a><a class="navbar__item navbar__link" href="/api/">API</a><a class="navbar__item navbar__link" href="/blog/">博客</a><a href="https://github.com/modern-js-dev/garfish/tree/main/dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>examples<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_LXM+"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/issues/">常见问题</a><a href="https://github.com/bytedance/garfish" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_dMKs toggle_JiXX toggleChecked_iAaC toggleDisabled_sQgZ"><div class="toggleTrack_9TPd" role="button" tabindex="-1"><div class="toggleTrackCheck_4DuB"><span class="toggleIcon_G7th">🌜</span></div><div class="toggleTrackX_NYQz"><span class="toggleIcon_G7th">🌞</span></div><div class="toggleTrackThumb_whxg"></div></div><input type="checkbox" checked="" class="toggleScreenReader_BQWn" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_Nvd-"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_IW1T searchBarLoadingRing_plej"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_sOUE"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_0hYg" type="button"></button><aside class="docSidebarContainer_smly"><div class="sidebar_JstF"><nav class="menu thin-scrollbar menu_SMhh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist" href="#">快速上手</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guide">介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guide/start">快速开始</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guide/env">环境变量</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">接入指南</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">核心能力</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">进阶</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/guide/advance/plugins">插件指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guide/advance/nested">嵌套场景</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_+uui"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_N15l"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_xpFD"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_xzir"><div class="docItemContainer_p2HY"><article><div class="tocCollapsible_Cvmz theme-doc-toc-mobile tocMobile_f5Vz"><button type="button" class="clean-btn tocCollapsibleButton_FYbz">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>插件指南</h1></header><p>Garfish 框架引入了插件化机制，目的是为了让开发者能够通过编写插件的方式扩展更多功能，或为自身业务定制个性化功能；同时框架的基础能力也都是通过插件机制来实现，确保框架核心足够精简和稳定。</p><h2 class="anchor anchorWithStickyNavbar_Vq32" id="插件能做什么">插件能做什么<a aria-hidden="true" class="hash-link" href="#插件能做什么" title="Direct link to heading">​</a></h2><p>插件的功能范围没有严格的限制——一般有下面两种：</p><ol><li>添加全局方法或增加默认参数</li><li>在应用的生命周期中自定义功能（例如：<code>Garfish router</code>、<code>Garfish sandbox</code>）</li></ol><h2 class="anchor anchorWithStickyNavbar_Vq32" id="编写插件">编写插件<a aria-hidden="true" class="hash-link" href="#编写插件" title="Direct link to heading">​</a></h2><p><code>Garfish Router</code> 增加了全局方法和应用的自动渲染和销毁能力，下面让我们来以 <code>Garfish router</code> 为例，如何编写一个插件，来实现路由的能力。</p><p>当插件被注册到 <code>Garfish</code> 框架时，将会调用插件函数并将 <code>GarfishInstance</code> 作为参数传递，函数的返回值中包括插件的基本信息：<code>name</code>、<code>version</code>，除了基本信息外最重要的则是包括 <code>hook</code>，<code>Garfish</code> 框架将在应用的整个生命周期中触发 <code>hook</code> 的调用，可以在 <code>hook</code> 中对信息进行二次处理或执行特定的功能。</p><p>让我们从编写插件函数开始，建议在单独的文件中创建它并将其导出，如下所示，以保持插件逻辑的整洁和分离，在实际开发过程中我们建议将实际插件的内容放置一个函数中返回，以便插件在实际调用时可接收参数</p><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// plugins/router.ts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> interfaces </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;garfish&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// function return plugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">GarfishRouter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_args</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Plugin code goes here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token maybe-class-name">GarfishInstance</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">Plugin</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;garfish-router&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      version</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;1.2.1&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><p><code>Garfish Router</code> 的这个 <code>plugin</code> 期望达到的目标是通过提供的 <code>Router Map</code> 后 <code>Garfish</code> 框架能够自动的完成微前端应用的渲染和销毁调度，从而降低典型中台中管理应用销毁和渲染的工作，提升开发效率。那么要实现这个需求我们需要依次实现以下功能：</p><ul><li>扩展类型<ul><li><code>appInfo</code> 的类型，让 <code>appInfo</code> 类型提示支持 <code>activeWhen</code>、<code>basename</code> 等配置</li><li><code>Garfish</code> 增加 <code>router</code> 类型</li></ul></li><li>为 <code>Garfish</code> 实例扩展 <code>router</code> 方法，用于实现路由跳转和路由监听等能力</li><li>监听 <code>bootstrap hook</code>（该 hook 会在主应用触发 <code>Garfish.run</code> 后调用），触发 <code>bootstrap</code> 后<ul><li>劫持路由变化：改写 <code>history.push</code>、<code>history.replace</code>，监听 <code>popstate</code> 浏览器后退事件</li><li>当路由发生变化时通过 <code>appInfo</code> 的 <code>activeWhen</code> 进行规则判断，对应用进行渲染和销毁</li></ul></li><li>监听 <code>registerApp hook</code>（该 hook 会在注册子应用时触发）<ul><li>当有新注册应用时对新应用进行检验是否如何渲染条件，进行销毁</li></ul></li></ul><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Garfish Router 就是通过 Garfish 的 Plugin 机制实现，以下案例精简了大部分逻辑，主要介绍如何编写插件来扩展 Garfish 的整体功能，若想了解实现，请参考 <a href="https://github.com/modern-js-dev/garfish/blob/260143bb70ca81c64069650ae278088a2ca8a62f/packages/router/src/index.ts" target="_blank" rel="noopener noreferrer"><code>Garfish Router plugin</code></a></p></div></div><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> interfaces </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;garfish&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">declare</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">module</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;garfish&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 为 GarfishInstance 添加 router 方法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">default</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(255, 203, 107)">Garfish</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">push</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">info</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        path</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        query</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        basename</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">replace</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">info</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        path</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        query</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        basename</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">namespace</span><span class="token plain"> interfaces </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 为全局配置增加 autoRefreshApp、onNotMatchRouter 参数类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(255, 203, 107)">Config</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      onNotMatchRouter</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">path</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Promise</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token keyword" style="font-style:italic">void</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:rgb(255, 203, 107)">AppInfo</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 手动加载，可不填写路由</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      activeWhen</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">path</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">boolean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      basename</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 这里仅做伪代码的演示，功能无法正常运行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">GarfishRouter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_args</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> autoRefreshApp</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">boolean</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token maybe-class-name">Garfish</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">Plugin</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 为 Garfish 实例添加 router 方法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">router</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">push</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> path </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> history</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">replace</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> path </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> history</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">replace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;router&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      version</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;1.0.0&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 在触发 Garfish.run 后启动路由监听，自动渲染和销毁应用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">bootstrap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">options</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">Options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> activeApp </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> unmounts</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Record</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Function</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> basename </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> apps </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">values</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">appInfos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 该函数会劫持 history 变化，当某个 appInfo 的 activeWhen 符合触发条件后会触发 active 回调</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 提供 appInfo 信息，这个时候通过 Garfish.loadApp 加载该应用并进行销毁</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 当某个 appInfo 处于已经渲染状态，并且在路由发生变化后处于销毁状态将会触发 deactive 回调</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 通过 appInfo，触发缓存的 app 实例的销毁函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">listenRouterAndReDirect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          basename</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">active</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfo</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">AppInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> rootPath</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> cache </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> active </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 当前应用处于激活状态后触发</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> app </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> </span><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">loadApp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              basename</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> rootPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              entry</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">entry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              cache</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              domGetter</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">domGetter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> isDes </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> cache </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">mounted</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              isDes </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">show</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              unmounts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> isDes </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> cache </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">mounted</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                isDes </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">show</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">mount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">deactive</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfo</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">AppInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> rootPath</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> deactive </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> unmount </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> unmounts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            unmount </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">unmount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          autoRefreshApp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          notMatch</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> onNotMatchRouter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          apps</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          listening</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">registerApp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 将新注册的应用信息注入到路由中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> appList </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">values</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">registerRouter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appList</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">activeWhen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 触发路由的重定向，检测当前应用是否需要触发渲染</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">initRedirect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><blockquote><p>插件编写总结</p></blockquote><ul><li>若要为 <code>Garfish</code> 实例扩展方法，通过 <code>declare module</code> 直接扩展 <code>Garfish</code> 的 <code>interfaces</code>，然后通过插件函数获取 <code>Garfish</code> 的实例直接添加方法，用于扩展 <code>Garfish</code> 的能力</li><li>可通过 <code>namespace interfaces</code> 直接扩展 <code>Garfish config</code> 和 <code>AppInfo</code> 配置</li><li>在对应用用的生命周期中进行能力的扩展</li></ul><h2 class="anchor anchorWithStickyNavbar_Vq32" id="插件公约">插件公约<a aria-hidden="true" class="hash-link" href="#插件公约" title="Direct link to heading">​</a></h2><ul><li>插件应该包括清晰的名称</li><li>如果插件单独封装至 <code>npm</code> 包，在 <code>package.json</code> 中添加 <code>garfish-plugin</code> 关键词</li><li>插件应该包括完备的测试</li><li>插件应该具备完整的使用文档</li><li>如果你觉得你的插件足够通用，请联系：<a href="mailto:zhouxiao.shaw@bytedance.com" target="_blank" rel="noopener noreferrer">zhouxiao.shaw@bytedance.com</a>，评估后是否是和加入推荐列表</li></ul><h2 class="anchor anchorWithStickyNavbar_Vq32" id="使用插件">使用插件<a aria-hidden="true" class="hash-link" href="#使用插件" title="Direct link to heading">​</a></h2><p>通过调用 <code>Garfish.usePlugin</code> 方法将插件添加到你的应用程序中。</p><p>我们将使用在 <a href="#%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E6%8F%92%E4%BB%B6"><code>如何编写插件</code></a> 部分中创建的 <code>routerPlugin</code> 插件进行演示。</p><p><code>usePlugin()</code> 方法第一个参数接收要安装的插件，在这种情况下为 <code>routerPlugin</code> 的返回值。</p><p>它还会自动阻止你多次使用同一插件，因此在同一插件上多次调用只会安装一次该插件，<code>Garfish</code> 内部通过插件执行后返回的 <code>name</code> 作为唯一标识来进行区分，在进行插件命名时，请确保不会和其他插件之间发生冲突。</p><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Garfish</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;garfish&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports">routerPlugin</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./plugins/router&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">usePlugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">routerPlugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_Vq32" id="useplugin"><code>usePlugin</code><a aria-hidden="true" class="hash-link" href="#useplugin" title="Direct link to heading">​</a></h2><p>通过 <code>Garfish.usePlugin</code> 可以注册插件</p><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">usePlugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function-variable function" style="color:rgb(130, 170, 255)">plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token maybe-class-name">GarfishInstance</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access maybe-class-name">Plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_Vq32" id="plugin"><code>plugin</code><a aria-hidden="true" class="hash-link" href="#plugin" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_Vq32" id="name"><code>name</code><a aria-hidden="true" class="hash-link" href="#name" title="Direct link to heading">​</a></h3><ul><li>Type: <code>string</code></li><li>插件的名称，作为插件的唯一标识和便于调试</li></ul><h3 class="anchor anchorWithStickyNavbar_Vq32" id="version"><code>version?</code><a aria-hidden="true" class="hash-link" href="#version" title="Direct link to heading">​</a></h3><ul><li>Type: <code>string</code></li><li>插件的版本号，用于观测线上环境使用使用的插件版本</li></ul><h3 class="anchor anchorWithStickyNavbar_Vq32" id="beforebootstrap"><code>beforeBootstrap?</code><a aria-hidden="true" class="hash-link" href="#beforebootstrap" title="Direct link to heading">​</a></h3><ul><li>Type: <code>(options: interfaces.Options) =&gt; void</code><ul><li>该 <code>hook</code> 的第一个参数为 <code>Garfish.run</code> 提供的配置信息</li></ul></li><li>Kind: <code>sync</code>, <code>sequential</code></li><li>Trigger:<ul><li>在 <a href="/api/run"><code>Garfish.run</code></a> 调用后触发</li><li>触发该 <code>hook</code> 时配置未注册到全局</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_Vq32" id="bootstrap"><code>bootstrap?</code><a aria-hidden="true" class="hash-link" href="#bootstrap" title="Direct link to heading">​</a></h3><ul><li>Type: <code>(options: interfaces.Options) =&gt; void</code><ul><li>该 <code>hook</code> 的第一个参数为 <code>Garfish.run</code> 提供的配置信息</li></ul></li><li>Kind: <code>sync</code>, <code>sequential</code></li><li>Trigger:<ul><li>在 <a href="/api/run"><code>Garfish.run</code></a> 调用后触发</li><li>触发该 <code>hook</code> 时配置已经注册到全局</li></ul></li><li>Previous Hook: <code>beforeBootstrap</code></li></ul><h3 class="anchor anchorWithStickyNavbar_Vq32" id="beforeregisterapp"><code>beforeRegisterApp?</code><a aria-hidden="true" class="hash-link" href="#beforeregisterapp" title="Direct link to heading">​</a></h3><ul><li>Type: <code>(appInfo: interfaces.AppInfo | Array&lt;interfaces.AppInfo&gt;) =&gt; void</code><ul><li>该 <code>hook</code> 的第一个参数为需要注册的应用信息</li></ul></li><li>Kind: <code>sync</code>, <code>sequential</code></li><li>Trigger:<ul><li>调用 <a href="/api/run"><code>Garfish.run</code></a> 且，提供了 <code>apps</code> 参数时触发</li><li>直接通过 <a href="/api/registerApp"><code>Garfish.registerApp</code></a> 调用时</li><li>触发该 <code>hook</code> 是子应用信息尚未注册成功</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_Vq32" id="registerapp"><code>registerApp?</code><a aria-hidden="true" class="hash-link" href="#registerapp" title="Direct link to heading">​</a></h3><ul><li>Type: <code>(appInfo: interfaces.AppInfo | Array&lt;interfaces.AppInfo&gt;) =&gt; void</code><ul><li>该 <code>hook</code> 的第一个参数为需要注册的应用信息</li></ul></li><li>Kind: <code>sync</code>, <code>sequential</code></li><li>Trigger:<ul><li>调用 <a href="/api/run"><code>Garfish.run</code></a> 且，提供了 <code>apps</code> 参数时触发</li><li>直接通过 <a href="/api/registerApp"><code>Garfish.registerApp</code></a> 调用时</li><li>触发该 <code>hook</code> 是子应用信息注册成功</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_Vq32" id="beforeload">beforeLoad<a aria-hidden="true" class="hash-link" href="#beforeload" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> async (appInfo: AppInfo, appInstance: App) =&gt; false | undefined </span></p><ul><li>该 <code>hook</code> 的参数分别为：应用信息、应用实例；</li><li>当返回 <code>false</code> 时将中断子应用的加载及后续流程；</li></ul></li><li><p>Kind: <code>async</code>, <code>sequential</code></p></li><li><p>Trigger:</p><ul><li>在调用 <code>Garfish.load</code> 时触发该 <code>hook</code></li><li>子应用加载前触发，此时还未开始加载子应用资源；</li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">beforeLoad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;子应用开始加载&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_Vq32" id="afterload">afterLoad<a aria-hidden="true" class="hash-link" href="#afterload" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> async (appInfo: AppInfo, appInstance: interfaces.App) =&gt; void </span></p></li><li><p>该 <code>hook</code> 的参数分别为：应用信息、应用实例；</p></li><li><p>Kind: <code>async</code>, <code>sequential</code></p></li><li><p>Trigger:</p><ul><li>在调用 <code>Garfish.load</code> 后并且子应用加载完成时触发该 <code>hook</code>；</li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">afterLoad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;子应用加载完成&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_Vq32" id="errorloadapp">errorLoadApp<a aria-hidden="true" class="hash-link" href="#errorloadapp" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> (error: Error, appInfo: AppInfo, appInstance: interfaces.App) =&gt; void </span></p><ul><li>该 <code>hook</code> 的参数分别为：<code>error</code> 实例、 <code>appInfo</code> 信息、<code>appInstance</code> 应用实例</li><li>一旦设置该 hook，子应用加载错误不会 throw 到文档流中，全局错误监听将无法捕获到；</li></ul></li><li><p>Kind: <code>sync</code>, <code>sequential</code></p></li><li><p>Trigger:</p><ul><li>在调用 <code>Garfish.load</code> 过程中，并且加载失败时触发该 <code>hook</code></li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">errorLoadApp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;子应用加载异常&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_Vq32" id="beforemount">beforeMount<a aria-hidden="true" class="hash-link" href="#beforemount" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> (appInfo: AppInfo, appInstance: interfaces.App, cacheMode: boolean) =&gt; void </span></p><ul><li>该 <code>hook</code> 的参数分别为：<code>appInfo</code> 信息、<code>appInstance</code> 应用实例、是否为 <code>缓存模式</code> 渲染和销毁</li></ul></li><li><p>Kind: <code>sync</code>, <code>sequential</code></p></li><li><p>Previous Hook: <code>beforeEval</code>、<code>afterEval</code></p></li><li><p>Trigger:</p><ul><li>此时子应用资源准备完成，运行时环境初始化完成，准备开始渲染子应用 DOM 树；</li><li>在调用 <code>app.mount</code> 或 <code>app.show</code> 触发该 <code>hook</code>，用户除了手动调用这两个方法外，<code>Garfish Router</code> 托管模式还会自动触发<ul><li>在使用 <code>app.mount</code> 渲染应用是 <code>cacheMode</code> 为 <code>false</code>；</li><li>在使用 <code>app.show</code> 渲染应用是 <code>cacheMode</code> 为 <code>true</code>；</li></ul></li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">beforeMount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;子应用开始渲染&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_Vq32" id="aftermount">afterMount<a aria-hidden="true" class="hash-link" href="#aftermount" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> (appInfo: AppInfo, appInstance: interfaces.App, cacheMode: boolean) =&gt; void </span></p><ul><li>该 <code>hook</code> 的参数分别为：<code>appInfo</code> 信息、<code>appInstance</code> 应用实例、是否为 <code>缓存模式</code> 渲染和销毁</li></ul></li><li><p>Kind: <code>sync</code>, <code>sequential</code></p></li><li><p>Previous Hook: <code>beforeLoad</code>、<code>afterLoad</code>、<code>beforeMount</code></p></li><li><p>Trigger:</p><ul><li>此时子应用 DOM 树已渲染完成，garfish 实例 <code>activeApps</code> 中已添加当前子应用 app 实例；</li><li>在挂载过程中，会调用应用生命周期中的 <a href="/guide/start#2%E5%AF%BC%E5%87%BA-provider-%E5%87%BD%E6%95%B0"><code>render</code> 函数</a>，用户可在挂载前定义相关操作；</li><li>若挂载过程中出现异常，会触发 <a href="/api/run#errormountapp">errorMountApp</a>，同时会清除已创建的 app 渲染容器 appContainer</li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">afterMount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;子应用渲染结束&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_Vq32" id="beforeeval">beforeEval<a aria-hidden="true" class="hash-link" href="#beforeeval" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> (appInfo: AppInfo, code: string, env: Record&lt;string, any&gt;, url: string, options) =&gt; void </span></p><ul><li>该 <code>hook</code> 的参数分别为：<code>appInfo</code> 信息、<code>code</code> 执行的代码、<code>env</code> 要注入的环境变量，<code>url</code> 代码的资源地址、<code>options</code> 参数选项（例如 <code>async</code> 是否异步执行、<code>noEntry</code> 是否是 <code>noEntry</code> 模式）；</li></ul></li><li><p>Kind: <code>sync</code>, <code>sequential</code></p></li><li><p>Previous Hook: <code>beforeMount</code></p></li><li><p>Trigger:</p><ul><li>在子应用挂载过程中、实际执行代码前触发该 hook；</li><li>应用 html 内的 script 和动态创建的脚本执行时都会触发该 hook</li><li>此时 DOM 树已添加至文档流中，子应用代码准备执行；</li><li>若代码执行过程中抛出异常，则将触发 <a href="/api/run#errormountapp">errorMountApp</a>，否则触发 <a href="/api/run#afterEval">beforeEval</a></li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">beforeEval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">beforeEval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;子应用代码开始执行&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_Vq32" id="aftereval">afterEval<a aria-hidden="true" class="hash-link" href="#aftereval" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> (appInfo: AppInfo, code: string, env: Record&lt;string, any&gt;, url: string, options) =&gt; void </span></p><ul><li>该 <code>hook</code> 的参数分别为：<code>appInfo</code> 信息、<code>code</code> 执行的代码、<code>env</code> 要注入的环境变量，<code>url</code> 应用访问地址、<code>options</code> 参数选项例如 <code>async</code> 是否异步执行、<code>noEntry</code> 是否是 <code>noEntry</code> 模式；</li></ul></li><li><p>Kind: <code>sync</code>, <code>sequential</code></p></li><li><p>Previous Hook: <code>beforeLoad</code>、<code>afterLoad</code></p></li><li><p>Trigger:</p><ul><li>在实际执行代码后。<code>afterMount</code> 触发前触发；</li><li>子应用 html 内的 script 和动态创建的脚本执行时都会触发该 hook</li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">afterEval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">afterEval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;子应用代码执行完成&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_Vq32" id="errormountapp">errorMountApp<a aria-hidden="true" class="hash-link" href="#errormountapp" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> (error: Error, appInfo: AppInfo, appInstance: interfaces.App) =&gt; void </span></p><ul><li>一旦设置该 hook，子应用加载错误不会 throw 到文档流中，全局错误监听将无法捕获到；</li></ul></li><li><p>Kind: <code>sync</code>, <code>sequential</code></p></li><li><p>Previous Hook: <code>beforeLoad</code>、<code>afterLoad</code>、<code>beforeMount</code>、<code>afterMount</code></p></li><li><p>Trigger:</p><ul><li>在渲染过程中出现异常会触发该 <code>hook</code>，子应用同步执行的代码出现异常会触发该 <code>hook</code>，异步代码无法触发</li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">errorMountApp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;子应用渲染异常&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_Vq32" id="beforeunmount">beforeUnmount<a aria-hidden="true" class="hash-link" href="#beforeunmount" title="Direct link to heading">​</a></h3><ul><li>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> ( appInfo: AppInfo, appInstance: interfaces.App) =&gt; void </span></li><li>Kind: <code>sync</code>, <code>sequential</code></li><li>Previous Hook: <code>beforeLoad</code>、<code>afterLoad</code>、<code>beforeMount</code>、<code>afterMount</code></li><li>Trigger:<ul><li>在调用 <code>app.unmount</code> 或 <code>app.hide</code> 触发该 <code>hook</code>，用户除了手动调用这两个方法外，<code>Garfish Router</code> 托管模式还会自动触发<ul><li>在使用 <code>app.unmount</code> 渲染应用是 <code>cacheMode</code> 为 <code>false</code>；</li><li>在使用 <code>app.hide</code> 渲染应用是 <code>cacheMode</code> 为 <code>true</code>；</li></ul></li><li>此时子应用 DOM 元素还未卸载，副作用尚未清除；</li><li>此时子应用 DOM 树已渲染完成，garfish 实例 <code>activeApps</code> 中已添加当前子应用 app 实例；</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_Vq32" id="afterunmount">afterUnmount<a aria-hidden="true" class="hash-link" href="#afterunmount" title="Direct link to heading">​</a></h3><ul><li>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> ( appInfo: AppInfo, appInstance: interfaces.App) =&gt; void </span></li><li>Kind: <code>sync</code>, <code>sequential</code></li><li>Trigger:<ul><li>此时，应用在渲和运行过程中产生的副作用已清除，DOM 已卸载，沙箱副作用已清除，garfish 实例 <code>activeApps</code> 当前 app 已移除；</li><li>在应用销毁过程中会调用应用生命周期中的 <a href="/guide/start#2%E5%AF%BC%E5%87%BA-provider-%E5%87%BD%E6%95%B0"><code>destory</code> 函数</a>，用户可在销毁前定义相关操作；</li><li>若应用卸载过程中出现异常，会触发 <a href="/api/run#errorUnmountApp">errorUnmountApp</a></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_Vq32" id="errorunmountapp">errorUnmountApp<a aria-hidden="true" class="hash-link" href="#errorunmountapp" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> (error: Error, appInfo: AppInfo, appInstance: interfaces.App)=&gt; void </span></p><ul><li>一旦设置该 hook，子应用销毁错误不会向上 throw 到文档流中，全局错误监听将无法捕获到；</li></ul></li><li><p>Kind: <code>sync</code>, <code>sequential</code></p></li><li><p>Trigger:</p><ul><li>在 <code>app.unmount</code> 或 <code>app.hide</code> 销毁过程中出现异常则会触发该 <code>hook</code>，用户除了手动调用这两个方法外，<code>Garfish Router</code> 托管模式还会自动触发</li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">errorUnmountApp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;子应用销毁异常&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_Vq32" id="onnotmatchrouter">onNotMatchRouter<a aria-hidden="true" class="hash-link" href="#onnotmatchrouter" title="Direct link to heading">​</a></h3><ul><li><p>Type: <span style="background-color:#ffffff0d;border-radius:1.5rem;color:#25c19f;padding:0.2rem 0.5rem"> (path: string)=&gt; void </span></p><ul><li>该 <code>hook</code> 的参数分别为：应用信息、应用实例；</li></ul></li><li><p>Kind: <code>sync</code>, <code>sequential</code></p></li><li><p>Trigger:</p><ul><li>路由发生变化当前未激活子应用且未匹配到任何子应用时触发</li></ul></li><li><p>示例</p></li></ul><div class="codeBlockContainer_FZ4e"><div class="codeBlockContent_gWhu ts"><pre tabindex="0" class="prism-code language-ts codeBlock_9X2x thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_13Sf"><span class="token-line" style="color:#bfc7d5"><span class="token maybe-class-name">Garfish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">onNotMatchRouter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;未匹配到子应用&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ZJwJ clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/bytedance/garfish/tree/main/website/docs/guide/advance/plugins.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dzjR" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3-hW"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-05-07T13:08:34.000Z">2022/5/7</time></b> by <b>Zhou xiao</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/guide/build-config"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->构建配置</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/guide/advance/nested"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">嵌套场景<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_KhLW thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#插件能做什么" class="table-of-contents__link toc-highlight">插件能做什么</a></li><li><a href="#编写插件" class="table-of-contents__link toc-highlight">编写插件</a></li><li><a href="#插件公约" class="table-of-contents__link toc-highlight">插件公约</a></li><li><a href="#使用插件" class="table-of-contents__link toc-highlight">使用插件</a></li><li><a href="#useplugin" class="table-of-contents__link toc-highlight"><code>usePlugin</code></a></li><li><a href="#plugin" class="table-of-contents__link toc-highlight"><code>plugin</code></a><ul><li><a href="#name" class="table-of-contents__link toc-highlight"><code>name</code></a></li><li><a href="#version" class="table-of-contents__link toc-highlight"><code>version?</code></a></li><li><a href="#beforebootstrap" class="table-of-contents__link toc-highlight"><code>beforeBootstrap?</code></a></li><li><a href="#bootstrap" class="table-of-contents__link toc-highlight"><code>bootstrap?</code></a></li><li><a href="#beforeregisterapp" class="table-of-contents__link toc-highlight"><code>beforeRegisterApp?</code></a></li><li><a href="#registerapp" class="table-of-contents__link toc-highlight"><code>registerApp?</code></a></li><li><a href="#beforeload" class="table-of-contents__link toc-highlight">beforeLoad</a></li><li><a href="#afterload" class="table-of-contents__link toc-highlight">afterLoad</a></li><li><a href="#errorloadapp" class="table-of-contents__link toc-highlight">errorLoadApp</a></li><li><a href="#beforemount" class="table-of-contents__link toc-highlight">beforeMount</a></li><li><a href="#aftermount" class="table-of-contents__link toc-highlight">afterMount</a></li><li><a href="#beforeeval" class="table-of-contents__link toc-highlight">beforeEval</a></li><li><a href="#aftereval" class="table-of-contents__link toc-highlight">afterEval</a></li><li><a href="#errormountapp" class="table-of-contents__link toc-highlight">errorMountApp</a></li><li><a href="#beforeunmount" class="table-of-contents__link toc-highlight">beforeUnmount</a></li><li><a href="#afterunmount" class="table-of-contents__link toc-highlight">afterUnmount</a></li><li><a href="#errorunmountapp" class="table-of-contents__link toc-highlight">errorUnmountApp</a></li><li><a href="#onnotmatchrouter" class="table-of-contents__link toc-highlight">onNotMatchRouter</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 ByteDance, Inc. Powered By Garfish Team</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e3f4e211.js"></script>
<script src="/assets/js/main.fd9dd10e.js"></script>
</body>
</html>